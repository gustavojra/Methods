import sys
sys.path.append('../Modules/')
from CASCCSD import CASCCSD
from TCCSD import TCCSD
from printtensor import *
from save_amp import *

molecule mol {
    0 1
    O
    H 1 0.96
    H 1 0.96 2 104.5
    symmetry c1
}

set {
    BASIS         cc-pvdz
    REFERENCE     RHF
    SCF_TYPE      PK
    SOSCF         True
    E_CONVERGENCE 12
    MAXITER       100
    MAX_ATTEMPTS  10
    NUM_DETS_PRINT 100000
    FCI           True
}

ccsd = energy('ccsd')
bccd = energy('bccd')

set {
    FROZEN_DOCC = [1]
    ACTIVE = [7]
}

e, wfn = energy('detci', return_wfn=True)
X = CASCCSD(wfn)

print_out('\nCAS energy:      {:<5.10f}\n'.format(e))
print_out('CASCCSD  energy: {:<5.10f}\n'.format(X.Ecc))
print_out('CCSD     energy: {:<5.10f}\n'.format(ccsd))
print_out('BCCD     energy: {:<5.10f}\n'.format(bccd))
